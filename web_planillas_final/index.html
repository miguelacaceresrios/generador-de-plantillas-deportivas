<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Planillas Deportivas</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <h1>Generador de Planillas Deportivas</h1>
        <p>Rellena e imprime planillas especializadas para cada deporte</p>
    </header>
    
    <div class="sports-selector">
        <button class="sport-btn active" data-sport="salto">Atletismo - Salto</button>
        <button class="sport-btn" data-sport="carrera">Atletismo - Carrera</button>
        <button class="sport-btn" data-sport="lanzamiento">Atletismo - Lanzamiento</button>
        <button class="sport-btn" data-sport="voleibol">Voleibol</button>
        <button class="sport-btn" data-sport="futbol">Fútbol</button>
        <button class="sport-btn" data-sport="baloncesto">Baloncesto</button>
    </div>
    
    <div class="container">
        <div class="form-container">
            <div class="form-header">
                <h2>Formulario de Datos</h2>
            </div>
            
            <!-- Formulario para Salto -->
            <div id="salto-form" class="sport-form active">
                <div class="form-group">
                    <label for="prueba-salto">Prueba</label>
                    <input type="text" id="prueba-salto" placeholder="Ej: Salto Alto">
                </div>
                
                <div class="form-group">
                    <label for="categoria-salto">Categoría</label>
                    <input type="text" id="categoria-salto" placeholder="Ej: Sub-15">
                </div>
                
                <div class="form-group">
                    <label for="genero-salto">Género</label>
                    <select id="genero-salto">
                        <option value="Masculino">Masculino</option>
                        <option value="Femenino">Femenino</option>
                        <option value="Mixto">Mixto</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="fecha-salto">Fecha</label>
                    <input type="date" id="fecha-salto">
                </div>
                
                <div class="form-group">
                    <label>Lista de Competidores</label>
                    <div id="competidores-salto-container">
                        <div class="competitor-row">
                            <input type="text" placeholder="Nombre y Apellidos" class="competidor-input">
                            <input type="text" placeholder="I.E." class="ie-input" style="width:120px;">
                            <input type="text" placeholder="L.E." class="le-input" style="width:100px;">
                            <input type="text" placeholder="Altura inicial" class="altura-input" style="width:110px;">
                            <input type="text" placeholder="Medidas Saltómetro" class="saltometro-input" style="width:130px;">
                            <input type="text" placeholder="Mejor salto" class="mejor-input" style="width:110px;">
                            <input type="text" placeholder="Nulo" class="nulo-input" style="width:70px;">
                            <input type="text" placeholder="Puesto" class="puesto-input" style="width:70px;">
                            <button class="remove-btn" onclick="removeCompetidor(this)">X</button>
                        </div>
                    </div>
                    <button type="button" onclick="addCompetidor('salto')" style="margin-top: 0.5rem;">+ Añadir Competidor</button>
                </div>
                
                <button onclick="generarPreview('salto')">Generar Vista Previa</button>
            </div>
            
            <!-- Formulario para Carrera -->
            <div id="carrera-form" class="sport-form">
                <div class="form-group">
                    <label for="prueba-carrera">Prueba</label>
                    <input type="text" id="prueba-carrera" placeholder="Ej: 100m planos">
                </div>
                
                <div class="form-group">
                    <label for="categoria-carrera">Categoría</label>
                    <input type="text" id="categoria-carrera" placeholder="Ej: Sub-15">
                </div>
                
                <div class="form-group">
                    <label for="pista-carrera">Pista</label>
                    <input type="text" id="pista-carrera" placeholder="Ej: Pista 1">
                </div>
                
                <div class="form-group">
                    <label for="fecha-carrera">Fecha</label>
                    <input type="date" id="fecha-carrera">
                </div>
                
                <div class="form-group">
                    <label>Lista de Competidores (con DNI e Institución Educativa)</label>
                    <div id="competidores-carrera-container">
                        <div class="competitor-row">
                            <input type="text" placeholder="Nombre y Apellidos" class="competidor-input">
                            <input type="text" placeholder="DNI" class="dni-input" style="width: 100px;">
                            <input type="text" placeholder="I.E." class="ie-input" style="width: 100px;">
                            <input type="text" placeholder="Tiempo" class="tiempo-input" style="width:110px;">
                            <input type="text" placeholder="Puesto" class="puesto-input" style="width:70px;">
                            <input type="text" placeholder="Observaciones" class="obs-input" style="width:140px;">
                            <button class="remove-btn" onclick="removeCompetidor(this)">X</button>
                        </div>
                    </div>
                    <button type="button" onclick="addCompetidor('carrera')" style="margin-top: 0.5rem;">+ Añadir Competidor</button>
                </div>
                
                <button onclick="generarPreview('carrera')">Generar Vista Previa</button>
            </div>
            
            <!-- Formulario para Lanzamiento -->
            <div id="lanzamiento-form" class="sport-form">
                <div class="form-group">
                    <label for="prueba-lanzamiento">Prueba</label>
                    <input type="text" id="prueba-lanzamiento" placeholder="Ej: Lanzamiento de jabalina">
                </div>
                
                <div class="form-group">
                    <label for="categoria-lanzamiento">Categoría</label>
                    <input type="text" id="categoria-lanzamiento" placeholder="Ej: Sub-15">
                </div>
                
                <div class="form-group">
                    <label for="fecha-lanzamiento">Fecha</label>
                    <input type="date" id="fecha-lanzamiento">
                </div>
                
                <div class="form-group">
                    <label>Lista de Competidores (con DNI e Institución Educativa)</label>
                    <div id="competidores-lanzamiento-container">
                        <div class="competitor-row">
                            <input type="text" placeholder="Nombre y Apellidos" class="competidor-input">
                            <input type="text" placeholder="DNI" class="dni-input" style="width: 100px;">
                            <input type="text" placeholder="I.E." class="ie-input" style="width: 100px;">
                            <input type="number" placeholder="1" class="intento-input" style="width:60px;">
                            <input type="number" placeholder="2" class="intento-input" style="width:60px;">
                            <input type="number" placeholder="3" class="intento-input" style="width:60px;">
                            <input type="number" placeholder="4" class="intento-input" style="width:60px;">
                            <input type="number" placeholder="5" class="intento-input" style="width:60px;">
                            <input type="number" placeholder="6" class="intento-input" style="width:60px;">
                            <input type="text" placeholder="Mejor Marca" class="mejor-input" style="width:110px;">
                            <input type="text" placeholder="Puesto" class="puesto-input" style="width:70px;">
                            <button class="remove-btn" onclick="removeCompetidor(this)">X</button>
                        </div>
                    </div>
                    <button type="button" onclick="addCompetidor('lanzamiento')" style="margin-top: 0.5rem;">+ Añadir Competidor</button>
                </div>
                
                <button onclick="generarPreview('lanzamiento')">Generar Vista Previa</button>
            </div>
            
            <!-- Formulario para Voleibol -->
            <div id="voleibol-form" class="sport-form">
                <div class="form-group">
                    <label for="torneo-voleibol">Torneo/Competencia</label>
                    <input type="text" id="torneo-voleibol" placeholder="Ej: Torneo Interescolar">
                </div>
                
                <div class="form-group">
                    <label for="categoria-voleibol">Categoría</label>
                    <input type="text" id="categoria-voleibol" placeholder="Ej: Sub-17">
                </div>
                
                <div class="form-group">
                    <label for="fecha-voleibol">Fecha</label>
                    <input type="date" id="fecha-voleibol">
                </div>
                
                <div class="form-group">
                    <label for="equipo-local-voleibol">Equipo Local</label>
                    <input type="text" id="equipo-local-voleibol" placeholder="Nombre del equipo local">
                </div>
                
                <div class="form-group">
                    <label for="equipo-visitante-voleibol">Equipo Visitante</label>
                    <input type="text" id="equipo-visitante-voleibol" placeholder="Nombre del equipo visitante">
                </div>
                
                <div class="form-group">
                    <label>Sets</label>
                    <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                        <div style="flex: 1;">
                            <label>Local</label>
                            <div style="display: flex; gap: 5px;">
                                <input type="number" min="0" class="set-score" id="set1-local">
                                <input type="number" min="0" class="set-score" id="set2-local">
                                <input type="number" min="0" class="set-score" id="set3-local">
                                <input type="number" min="0" class="set-score" id="set4-local">
                                <input type="number" min="0" class="set-score" id="set5-local">
                            </div>
                        </div>
                        <div style="flex: 1;">
                            <label>Visitante</label>
                            <div style="display: flex; gap: 5px;">
                                <input type="number" min="0" class="set-score" id="set1-visitante">
                                <input type="number" min="0" class="set-score" id="set2-visitante">
                                <input type="number" min="0" class="set-score" id="set3-visitante">
                                <input type="number" min="0" class="set-score" id="set4-visitante">
                                <input type="number" min="0" class="set-score" id="set5-visitante">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Plantilla - Local</label>
                    <div id="plantilla-local-voleibol" class="team-players">
                        <div class="competitor-row">
                            <input type="text" placeholder="Nombre jugador" class="competidor-input">
                            <input type="number" placeholder="Dorsal" class="dorsal-input" style="width: 80px;">
                            <button class="remove-btn" onclick="removeRow(this)">X</button>
                        </div>
                    </div>
                    <button type="button" onclick="addPlayerVoleibol('local')" style="margin-top:0.5rem;">+ Añadir jugador (Local)</button>
                </div>

                <div class="form-group">
                    <label>Plantilla - Visitante</label>
                    <div id="plantilla-visitante-voleibol" class="team-players">
                        <div class="competitor-row">
                            <input type="text" placeholder="Nombre jugador" class="competidor-input">
                            <input type="number" placeholder="Dorsal" class="dorsal-input" style="width: 80px;">
                            <button class="remove-btn" onclick="removeRow(this)">X</button>
                        </div>
                    </div>
                    <button type="button" onclick="addPlayerVoleibol('visitante')" style="margin-top:0.5rem;">+ Añadir jugador (Visitante)</button>
                </div>
                
                <button onclick="generarPreview('voleibol')">Generar Vista Previa</button>
            </div>
            
            <!-- Formulario para Fútbol -->
            <div id="futbol-form" class="sport-form">
                <div class="form-group">
                    <label for="torneo-futbol">Torneo/Competencia</label>
                    <input type="text" id="torneo-futbol" placeholder="Ej: Campeonato Intercolegial">
                </div>
                
                <div class="form-group">
                    <label for="categoria-futbol">Categoría</label>
                    <input type="text" id="categoria-futbol" placeholder="Ej: Sub-16">
                </div>
                
                <div class="form-group">
                    <label for="fecha-futbol">Fecha</label>
                    <input type="date" id="fecha-futbol">
                </div>
                
                <div class="form-group">
                    <label for="equipo-local-futbol">Equipo Local</label>
                    <input type="text" id="equipo-local-futbol" placeholder="Nombre del equipo local">
                </div>
                
                <div class="form-group">
                    <label for="equipo-visitante-futbol">Equipo Visitante</label>
                    <input type="text" id="equipo-visitante-futbol" placeholder="Nombre del equipo visitante">
                </div>
                
                <div class="form-group">
                    <label for="goles-local-futbol">Goles - Local</label>
                    <input type="number" min="0" id="goles-local-futbol">
                </div>
                
                <div class="form-group">
                    <label for="goles-visitante-futbol">Goles - Visitante</label>
                    <input type="number" min="0" id="goles-visitante-futbol">
                </div>
                
                <div class="form-group">
                    <label for="incidencias-futbol">Incidencias (tarjetas, goles, etc.)</label>
                    <textarea id="incidencias-futbol" rows="4" placeholder="Detalle de goles, tarjetas, cambios..."></textarea>
                </div>
                
                <div class="form-group">
                    <label>Plantilla - Local</label>
                    <div id="plantilla-local-futbol" class="team-players">
                        <div class="competitor-row">
                            <input type="text" placeholder="Nombre jugador" class="competidor-input">
                            <input type="number" placeholder="Dorsal" class="dorsal-input" style="width: 80px;">
                            <button class="remove-btn" onclick="removeRow(this)">X</button>
                        </div>
                    </div>
                    <button type="button" onclick="addPlayerFootball('local')" style="margin-top: 0.5rem;">+ Añadir jugador (Local)</button>
                </div>

                <div class="form-group">
                    <label>Plantilla - Visitante</label>
                    <div id="plantilla-visitante-futbol" class="team-players">
                        <div class="competitor-row">
                            <input type="text" placeholder="Nombre jugador" class="competidor-input">
                            <input type="number" placeholder="Dorsal" class="dorsal-input" style="width: 80px;">
                            <button class="remove-btn" onclick="removeRow(this)">X</button>
                        </div>
                    </div>
                    <button type="button" onclick="addPlayerFootball('visitante')" style="margin-top: 0.5rem;">+ Añadir jugador (Visitante)</button>
                </div>
                
                <button onclick="generarPreview('futbol')">Generar Vista Previa</button>
            </div>
            
            <!-- Formulario para Baloncesto -->
            <div id="baloncesto-form" class="sport-form">
                <div class="form-group">
                    <label for="torneo-baloncesto">Torneo/Competencia</label>
                    <input type="text" id="torneo-baloncesto" placeholder="Ej: Liga Escolar">
                </div>
                
                <div class="form-group">
                    <label for="categoria-baloncesto">Categoría</label>
                    <input type="text" id="categoria-baloncesto" placeholder="Ej: Sub-14">
                </div>
                
                <div class="form-group">
                    <label for="fecha-baloncesto">Fecha</label>
                    <input type="date" id="fecha-baloncesto">
                </div>
                
                <div class="form-group">
                    <label for="equipo-local-baloncesto">Equipo Local</label>
                    <input type="text" id="equipo-local-baloncesto" placeholder="Nombre del equipo local">
                </div>
                
                <div class="form-group">
                    <label for="equipo-visitante-baloncesto">Equipo Visitante</label>
                    <input type="text" id="equipo-visitante-baloncesto" placeholder="Nombre del equipo visitante">
                </div>
                
                <div class="form-group">
                    <label for="puntos-local-baloncesto">Puntos - Local (opcional)</label>
                    <input type="number" min="0" id="puntos-local-baloncesto" placeholder="Si quieres, escribe aquí el total">
                </div>
                
                <div class="form-group">
                    <label for="puntos-visitante-baloncesto">Puntos - Visitante (opcional)</label>
                    <input type="number" min="0" id="puntos-visitante-baloncesto" placeholder="Si quieres, escribe aquí el total">
                </div>
                
                <!-- Cuartos con IDs para poder sumar -->
                <div class="form-group">
                    <label for="">Puntos por Cuarto</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <label>Local</label>
                            <div style="display: flex; gap: 5px;">
                                <input type="number" min="0" id="q1-local" class="set-score" placeholder="Q1">
                                <input type="number" min="0" id="q2-local" class="set-score" placeholder="Q2">
                                <input type="number" min="0" id="q3-local" class="set-score" placeholder="Q3">
                                <input type="number" min="0" id="q4-local" class="set-score" placeholder="Q4">
                            </div>
                        </div>
                        <div>
                            <label>Visitante</label>
                            <div style="display: flex; gap: 5px;">
                                <input type="number" min="0" id="q1-visitante" class="set-score" placeholder="Q1">
                                <input type="number" min="0" id="q2-visitante" class="set-score" placeholder="Q2">
                                <input type="number" min="0" id="q3-visitante" class="set-score" placeholder="Q3">
                                <input type="number" min="0" id="q4-visitante" class="set-score" placeholder="Q4">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Plantillas editables -->
                <div class="form-group">
                    <label>Plantilla - Local</label>
                    <div id="plantilla-local-baloncesto" class="team-players">
                        <div class="competitor-row">
                            <input type="text" placeholder="Nombre jugador" class="competidor-input">
                            <input type="number" placeholder="Dorsal" class="dorsal-input" style="width: 80px;">
                            <button class="remove-btn" onclick="removeRow(this)">X</button>
                        </div>
                    </div>
                    <button type="button" onclick="addPlayer('local')" style="margin-top: 0.5rem;">+ Añadir jugador (Local)</button>
                </div>

                <div class="form-group">
                    <label>Plantilla - Visitante</label>
                    <div id="plantilla-visitante-baloncesto" class="team-players">
                        <div class="competitor-row">
                            <input type="text" placeholder="Nombre jugador" class="competidor-input">
                            <input type="number" placeholder="Dorsal" class="dorsal-input" style="width: 80px;">
                            <button class="remove-btn" onclick="removeRow(this)">X</button>
                        </div>
                    </div>
                    <button type="button" onclick="addPlayer('visitante')" style="margin-top: 0.5rem;">+ Añadir jugador (Visitante)</button>
                </div>
                
                <button onclick="generarPreview('baloncesto')">Generar Vista Previa</button>
            </div>
        </div>
        
        <div class="preview-container">
            <div class="preview-header">
                <h2>Vista Previa</h2>
            </div>
            
            <div id="preview">
                <!-- La vista previa se generará dinámicamente -->
            </div>
            
            <div class="no-print" style="text-align: center; margin-top: 2rem;">
                <button class="btn-print" onclick="window.print()">Imprimir Plantilla</button>
            </div>
        </div>
    </div>

    <script>
        // Cambiar entre deportes
        document.querySelectorAll('.sport-btn').forEach(button => {
            button.addEventListener('click', () => {
                const sport = button.getAttribute('data-sport');
                
                document.querySelectorAll('.sport-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelectorAll('.sport-form').forEach(form => {
                    form.classList.remove('active');
                });
                
                button.classList.add('active');
                document.getElementById(`${sport}-form`).classList.add('active');
                
                // Generar vista previa para el deporte seleccionado
                generarPreview(sport);
            });
        });
        
        // Añadir competidor
        function addCompetidor(sport) {
            const container = document.getElementById(`competidores-${sport}-container`);
            const competitorRow = document.createElement('div');
            competitorRow.className = 'competitor-row';
            
            if (sport === 'salto') {
                competitorRow.innerHTML = `
                    <input type="text" placeholder="Nombre y Apellidos" class="competidor-input">
                    <input type="text" placeholder="I.E." class="ie-input" style="width:120px;">
                    <input type="text" placeholder="L.E." class="le-input" style="width:100px;">
                    <input type="text" placeholder="Altura inicial" class="altura-input" style="width:110px;">
                    <input type="text" placeholder="Medidas Saltómetro" class="saltometro-input" style="width:130px;">
                    <input type="text" placeholder="Mejor salto" class="mejor-input" style="width:110px;">
                    <input type="text" placeholder="Nulo" class="nulo-input" style="width:70px;">
                    <input type="text" placeholder="Puesto" class="puesto-input" style="width:70px;">
                    <button class="remove-btn" onclick="removeCompetidor(this)">X</button>
                `;
            } else if (sport === 'carrera') {
                competitorRow.innerHTML = `
                    <input type="text" placeholder="Nombre y Apellidos" class="competidor-input">
                    <input type="text" placeholder="DNI" class="dni-input" style="width:100px;">
                    <input type="text" placeholder="I.E." class="ie-input" style="width:100px;">
                    <input type="text" placeholder="Tiempo" class="tiempo-input" style="width:110px;">
                    <input type="text" placeholder="Puesto" class="puesto-input" style="width:70px;">
                    <input type="text" placeholder="Observaciones" class="obs-input" style="width:140px;">
                    <button class="remove-btn" onclick="removeCompetidor(this)">X</button>
                `;
            } else if (sport === 'lanzamiento') {
                competitorRow.innerHTML = `
                    <input type="text" placeholder="Nombre y Apellidos" class="competidor-input">
                    <input type="text" placeholder="DNI" class="dni-input" style="width:100px;">
                    <input type="text" placeholder="I.E." class="ie-input" style="width:100px;">
                    <input type="number" placeholder="1" class="intento-input" style="width:60px;">
                    <input type="number" placeholder="2" class="intento-input" style="width:60px;">
                    <input type="number" placeholder="3" class="intento-input" style="width:60px;">
                    <input type="number" placeholder="4" class="intento-input" style="width:60px;">
                    <input type="number" placeholder="5" class="intento-input" style="width:60px;">
                    <input type="number" placeholder="6" class="intento-input" style="width:60px;">
                    <input type="text" placeholder="Mejor Marca" class="mejor-input" style="width:110px;">
                    <input type="text" placeholder="Puesto" class="puesto-input" style="width:70px;">
                    <button class="remove-btn" onclick="removeCompetidor(this)">X</button>
                `;
            } else {
                competitorRow.innerHTML = `
                    <input type="text" placeholder="Nombre y Apellidos" class="competidor-input">
                    <input type="text" placeholder="DNI" class="dni-input" style="width: 100px;">
                    <input type="text" placeholder="I.E." class="ie-input" style="width: 100px;">
                    <button class="remove-btn" onclick="removeCompetidor(this)">X</button>
                `;
            }
            
            container.appendChild(competitorRow);
        }
        
        // Eliminar competidor
        function removeCompetidor(button) {
            const row = button.closest('.competitor-row');
            const container = row.parentElement;
            if (container.querySelectorAll('.competitor-row').length > 1) {
                row.remove();
            } else {
                // si es la última fila, simplemente limpiar inputs
                row.querySelectorAll('input').forEach(i => i.value = '');
            }
        }

        // Funciones para plantillas de baloncesto
        function addPlayer(team) {
            const container = document.getElementById(team === 'local' ? 'plantilla-local-baloncesto' : 'plantilla-visitante-baloncesto');
            const row = document.createElement('div');
            row.className = 'competitor-row';
            row.innerHTML = `<input type="text" placeholder="Nombre jugador" class="competidor-input"><input type="number" placeholder="Dorsal" class="dorsal-input" style="width: 80px;"><button class="remove-btn" onclick="removeRow(this)">X</button>`;
            container.appendChild(row);
        }

        function addPlayerFootball(team) {
            const container = document.getElementById(team === 'local' ? 'plantilla-local-futbol' : 'plantilla-visitante-futbol');
            const row = document.createElement('div');
            row.className = 'competitor-row';
            row.innerHTML = `<input type="text" placeholder="Nombre jugador" class="competidor-input"><input type="number" placeholder="Dorsal" class="dorsal-input" style="width: 80px;"><button class="remove-btn" onclick="removeRow(this)">X</button>`;
            container.appendChild(row);
        }

        function removeRow(button) {
            const row = button.closest('.competitor-row');
            const container = row.parentElement;
            if (container.querySelectorAll('.competitor-row').length > 1) {
                row.remove();
            } else {
                row.querySelectorAll('input').forEach(i => i.value = '');
            }
        }
        
        // Generar vista previa según el deporte (salto prefill de campos adicionales)
        function generarPreview(sport) {
            let previewHTML = '';
            
            switch(sport) {
                case 'salto':
                    const pruebaSalto = document.getElementById('prueba-salto').value || '[Prueba]';
                    const categoriaSalto = document.getElementById('categoria-salto').value || '[Categoría]';
                    const generoSalto = document.getElementById('genero-salto').value || '[Género]';
                    const fechaSalto = document.getElementById('fecha-salto').value || '[Fecha]';
                    
                    // Obtener competidores con sus campos adicionales
                    const competidoresSalto = [];
                    document.querySelectorAll('#competidores-salto-container .competitor-row').forEach(row => {
                        const nombre = (row.querySelector('.competidor-input') && row.querySelector('.competidor-input').value) || '';
                        const ie = (row.querySelector('.ie-input') && row.querySelector('.ie-input').value) || '';
                        const le = (row.querySelector('.le-input') && row.querySelector('.le-input').value) || '';
                        const altura = (row.querySelector('.altura-input') && row.querySelector('.altura-input').value) || '';
                        const saltometro = (row.querySelector('.saltometro-input') && row.querySelector('.saltometro-input').value) || '';
                        const mejor = (row.querySelector('.mejor-input') && row.querySelector('.mejor-input').value) || '';
                        const nulo = (row.querySelector('.nulo-input') && row.querySelector('.nulo-input').value) || '';
                        const puesto = (row.querySelector('.puesto-input') && row.querySelector('.puesto-input').value) || '';
                        competidoresSalto.push({nombre, ie, le, altura, saltometro, mejor, nulo, puesto});
                    });
                    
                    previewHTML = `
                        <div class="template-title">Formatos Oficiales para Competencias</div>
                        
                        
                        <div class="template-info">
                            <div class="info-item"><strong>PRUEBA:</strong> ${pruebaSalto}</div>
                            <div class="info-item"><strong>CATEGORIA:</strong> ${categoriaSalto}</div>
                            <div class="info-item"><strong>GENERO:</strong> ${generoSalto}</div>
                            <div class="info-item"><strong>FECHA:</strong> ${fechaSalto}</div>
                        </div>
                        
                        <table class="template">
                            <thead>
                                <tr>
                                    <th>N°</th>
                                    <th>Nombre y Apellidos</th>
                                    <th>L.E.</th>
                                    <th>Altura inicial</th>
                                    <th>Medidas del Saltómetro</th>
                                    <th>Mejor salto</th>
                                    <th>Nulo</th>
                                    <th>Puesto</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${competidoresSalto.map((c, index) => `
                                    <tr>
                                        <td>${index + 1}</td>
                                        <td><input class="preview-input" value="${c.nombre}"></td>
                                        <td><input class="preview-input" value="${c.le}"></td>
                                        <td><input class="preview-input" value="${c.altura}"></td>
                                        <td><input class="preview-input" value="${c.saltometro}"></td>
                                        <td><input class="preview-input" value="${c.mejor}"></td>
                                        <td><input class="preview-input" value="${c.nulo}"></td>
                                        <td><input class="preview-input" value="${c.puesto}"></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                    break;
                    
                case 'carrera':
                    const pruebaCarrera = document.getElementById('prueba-carrera').value || '[Prueba]';
                    const categoriaCarrera = document.getElementById('categoria-carrera').value || '[Categoría]';
                    const pistaCarrera = document.getElementById('pista-carrera').value || '[Pista]';
                    
                    // Obtener competidores con tiempo/puesto/observaciones
                    const competidoresCarrera = [];
                    document.querySelectorAll('#competidores-carrera-container .competitor-row').forEach(row => {
                        const nombre = row.querySelector('.competidor-input').value || '';
                        const dni = row.querySelector('.dni-input') ? row.querySelector('.dni-input').value : '';
                        const ie = row.querySelector('.ie-input') ? row.querySelector('.ie-input').value : '';
                        const tiempo = row.querySelector('.tiempo-input') ? row.querySelector('.tiempo-input').value : '';
                        const puesto = row.querySelector('.puesto-input') ? row.querySelector('.puesto-input').value : '';
                        const obs = row.querySelector('.obs-input') ? row.querySelector('.obs-input').value : '';
                        competidoresCarrera.push({nombre, dni, ie, tiempo, puesto, obs});
                    });
                    
                    previewHTML = `
                        <div class="template-title">Formatos Oficiales para Competencias</div>
                        
                        
                        <div class="template-info">
                            <div class="info-item"><strong>PRUEBA:</strong> ${pruebaCarrera}</div>
                            <div class="info-item"><strong>CATEGORIA:</strong> ${categoriaCarrera}</div>
                            <div class="info-item"><strong>PISTA:</strong> ${pistaCarrera}</div>
                        </div>
                        
                        <table class="template">
                            <thead>
                                <tr>
                                    <th>N°</th>
                                    <th>Nombres y Apellidos</th>
                                    <th>DNI</th>
                                    <th>I.E.</th>
                                    <th>Tiempo</th>
                                    <th>Puesto</th>
                                    <th>Observaciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${competidoresCarrera.map((c, i) => `
                                    <tr>
                                        <td>${i+1}</td>
                                        <td><input class="preview-input" value="${c.nombre}"></td>
                                        <td><input class="preview-input" value="${c.dni}"></td>
                                        <td><input class="preview-input" value="${c.ie}"></td>
                                        <td><input class="preview-input" value="${c.tiempo}"></td>
                                        <td><input class="preview-input" value="${c.puesto}"></td>
                                        <td><input class="preview-input" value="${c.obs}"></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                    break;
                    
                case 'lanzamiento':
                    const pruebaLanzamiento = document.getElementById('prueba-lanzamiento').value || '[Prueba]';
                    const categoriaLanzamiento = document.getElementById('categoria-lanzamiento').value || '[Categoría]';
                    
                    // Obtener competidores
                    const competidoresLanzamiento = [];
                    document.querySelectorAll('#competidores-lanzamiento-container .competitor-row').forEach(row => {
                        const nombre = row.querySelector('.competidor-input').value || '';
                        const dni = row.querySelector('.dni-input') ? row.querySelector('.dni-input').value : '';
                        const ie = row.querySelector('.ie-input') ? row.querySelector('.ie-input').value : '';
                        const intentos = Array.from(row.querySelectorAll('.intento-input')).map(i => i.value || '');
                        const mejor = row.querySelector('.mejor-input') ? row.querySelector('.mejor-input').value : '';
                        const puesto = row.querySelector('.puesto-input') ? row.querySelector('.puesto-input').value : '';
                        competidoresLanzamiento.push({nombre, dni, ie, intentos, mejor, puesto});
                    });
                    
                    previewHTML = `
                        <div class="template-title">Formatos Oficiales para Competencias</div>
                        
                        
                        <div class="template-info">
                            <div class="info-item"><strong>PRUEBA:</strong> ${pruebaLanzamiento}</div>
                            <div class="info-item"><strong>CATEGORIA:</strong> ${categoriaLanzamiento}</div>
                        </div>
                        
                        <table class="template">
                            <thead>
                                <tr>
                                    <th>Orden</th>
                                    <th>Nombres y Apellidos</th>
                                    <th>DNI</th>
                                    <th>I.E.</th>
                                    <th>1</th>
                                    <th>2</th>
                                    <th>3</th>
                                    <th>4</th>
                                    <th>5</th>
                                    <th>6</th>
                                    <th>Mejor Marca</th>
                                    <th>Puesto</th>
                                    <th>Observaciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${competidoresLanzamiento.map((c, i) => `
                                    <tr>
                                        <td>${i+1}</td>
                                        <td><input class="preview-input" value="${c.nombre}"></td>
                                        <td><input class="preview-input" value="${c.dni}"></td>
                                        <td><input class="preview-input" value="${c.ie}"></td>
                                        <td><input type="number" class="preview-input" value="${c.intentos[0] || ''}"></td>
                                        <td><input type="number" class="preview-input" value="${c.intentos[1] || ''}"></td>
                                        <td><input type="number" class="preview-input" value="${c.intentos[2] || ''}"></td>
                                        <td><input type="number" class="preview-input" value="${c.intentos[3] || ''}"></td>
                                        <td><input type="number" class="preview-input" value="${c.intentos[4] || ''}"></td>
                                        <td><input type="number" class="preview-input" value="${c.intentos[5] || ''}"></td>
                                        <td><input class="preview-input" value="${c.mejor}"></td>
                                        <td><input class="preview-input" value="${c.puesto}"></td>
                                        <td><input class="preview-input"></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                    break;
                    
                case 'voleibol':
                    const torneoVoleibol = document.getElementById('torneo-voleibol').value || '[Torneo]';
                    const categoriaVoleibol = document.getElementById('categoria-voleibol').value || '[Categoría]';
                    const equipoLocalVoleibol = document.getElementById('equipo-local-voleibol').value || '[Equipo Local]';
                    const equipoVisitanteVoleibol = document.getElementById('equipo-visitante-voleibol').value || '[Equipo Visitante]';

                    // tomar valores de sets del formulario para prefijar la preview
                    const vSetsLocal = [
                        document.getElementById('set1-local').value || '',
                        document.getElementById('set2-local').value || '',
                        document.getElementById('set3-local').value || '',
                        document.getElementById('set4-local').value || '',
                        document.getElementById('set5-local').value || ''
                    ];
                    const vSetsVisit = [
                        document.getElementById('set1-visitante').value || '',
                        document.getElementById('set2-visitante').value || '',
                        document.getElementById('set3-visitante').value || '',
                        document.getElementById('set4-visitante').value || '',
                        document.getElementById('set5-visitante').value || ''
                    ];

                    previewHTML = `
                        <div class="template-title">Formatos Oficiales para Competencias</div>
                        <div class="template-subtitle">${torneoVoleibol}</div>
                        <div class="template-info">
                            <div class="info-item"><strong>CATEGORIA:</strong> ${categoriaVoleibol}</div>
                        </div>

                        <div style="display:flex;justify-content:space-between;margin-bottom:1rem;">
                            <div><strong>Local:</strong> ${equipoLocalVoleibol}</div>
                            <div><strong>Visitante:</strong> ${equipoVisitanteVoleibol}</div>
                        </div>

                        <table class="template">
                            <thead>
                                <tr>
                                    <th>Set</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>${equipoLocalVoleibol}</strong></td>
                                    <td><input type="number" class="vp-set" data-team="local" data-index="0" value="${vSetsLocal[0]}"></td>
                                    <td><input type="number" class="vp-set" data-team="local" data-index="1" value="${vSetsLocal[1]}"></td>
                                    <td><input type="number" class="vp-set" data-team="local" data-index="2" value="${vSetsLocal[2]}"></td>
                                    <td><input type="number" class="vp-set" data-team="local" data-index="3" value="${vSetsLocal[3]}"></td>
                                    <td><input type="number" class="vp-set" data-team="local" data-index="4" value="${vSetsLocal[4]}"></td>
                                    <td><input readonly class="preview-total vp-total" data-team="local"></td>
                                </tr>
                                <tr>
                                    <td><strong>${equipoVisitanteVoleibol}</strong></td>
                                    <td><input type="number" class="vp-set" data-team="visitante" data-index="0" value="${vSetsVisit[0]}"></td>
                                    <td><input type="number" class="vp-set" data-team="visitante" data-index="1" value="${vSetsVisit[1]}"></td>
                                    <td><input type="number" class="vp-set" data-team="visitante" data-index="2" value="${vSetsVisit[2]}"></td>
                                    <td><input type="number" class="vp-set" data-team="visitante" data-index="3" value="${vSetsVisit[3]}"></td>
                                    <td><input type="number" class="vp-set" data-team="visitante" data-index="4" value="${vSetsVisit[4]}"></td>
                                    <td><input readonly class="preview-total vp-total" data-team="visitante"></td>
                                </tr>
                            </tbody>
                        </table>
                    `;
                    break;
                    
                case 'futbol':
                    const torneoFutbol = document.getElementById('torneo-futbol').value || '[Torneo]';
                    const equipoLocalFutbol = document.getElementById('equipo-local-futbol').value || '[Local]';
                    const equipoVisitanteFutbol = document.getElementById('equipo-visitante-futbol').value || '[Visitante]';
                    const golesLocalFutbol = document.getElementById('goles-local-futbol').value || '';
                    const golesVisitanteFutbol = document.getElementById('goles-visitante-futbol').value || '';
                    const incidenciasFutbol = document.getElementById('incidencias-futbol').value || '';

                    // obtener plantillas desde el formulario
                    const playersLocalFutbol = Array.from(document.querySelectorAll('#plantilla-local-futbol .competitor-row')).map(r => {
                        return {
                            name: r.querySelector('.competidor-input') ? r.querySelector('.competidor-input').value : '',
                            dorsal: r.querySelector('.dorsal-input') ? r.querySelector('.dorsal-input').value : ''
                        };
                    });
                    const playersVisitFutbol = Array.from(document.querySelectorAll('#plantilla-visitante-futbol .competitor-row')).map(r => {
                        return {
                            name: r.querySelector('.competidor-input') ? r.querySelector('.competidor-input').value : '',
                            dorsal: r.querySelector('.dorsal-input') ? r.querySelector('.dorsal-input').value : ''
                        };
                    });

                    // helper para renderizar filas usando plantilla si existe, si no dejar inputs vacíos
                    function renderPlayerRows(players, count) {
                        let rows = '';
                        for (let i = 0; i < count; i++) {
                            const p = players[i] || {name: '', dorsal: ''};
                            rows += `<tr>
                                <td><input class="preview-input" value="${p.name}"></td>
                                <td><input class="preview-input" style="width:60px;" value="${p.dorsal}"></td>
                                <td><input class="preview-input"></td>
                                <td><input class="preview-input"></td>
                                <td><input class="preview-input"></td>
                            </tr>`;
                        }
                        return rows;
                    }

                    previewHTML = `
                        <div class="template-title">Formatos Oficiales para Competencias</div>
                        <div class="template-subtitle">${torneoFutbol}</div>
                        <div class="template-info">
                            <div class="info-item"><strong>Local:</strong> ${equipoLocalFutbol}</div>
                            <div class="info-item"><strong>Visitante:</strong> ${equipoVisitanteFutbol}</div>
                        </div>

                        <div style="text-align:center;margin-bottom:1rem;">
                            <h2>Resultado: <input type="number" class="preview-score" id="print-goles-local" value="${golesLocalFutbol}" style="width:60px;"> - <input type="number" class="preview-score" id="print-goles-visitante" value="${golesVisitanteFutbol}" style="width:60px;"></h2>
                        </div>

                        <table class="template">
                            <thead>
                                <tr>
                                    <th>Equipo</th>
                                    <th>Jugador</th>
                                    <th>Dorsal</th>
                                    <th>Goles</th>
                                    <th>Amonestaciones</th>
                                    <th>Expulsiones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td rowspan="11"><strong>${equipoLocalFutbol}</strong></td>
                                    <td colspan="5"><input class="preview-input" placeholder="Titulares / Plantilla"></td>
                                </tr>
                                ${renderPlayerRows(playersLocalFutbol, 11)}
                                <tr>
                                    <td colspan="5"><input class="preview-input" placeholder="Suplentes"></td>
                                </tr>
                                ${renderPlayerRows(playersLocalFutbol.slice(11), 5)}
                                <tr>
                                    <td rowspan="11"><strong>${equipoVisitanteFutbol}</strong></td>
                                    <td colspan="5"><input class="preview-input" placeholder="Titulares / Plantilla"></td>
                                </tr>
                                ${renderPlayerRows(playersVisitFutbol, 11)}
                                <tr>
                                    <td colspan="5"><input class="preview-input" placeholder="Suplentes"></td>
                                </tr>
                                ${renderPlayerRows(playersVisitFutbol.slice(11), 5)}
                            </tbody>
                        </table>

                        <div style="margin-top:1rem;">
                            <h3>Incidencias</h3>
                            <textarea class="preview-input" style="min-height:100px;">${incidenciasFutbol}</textarea>
                        </div>
                    `;
                    break;
                    
                case 'baloncesto':
                    const torneoBaloncesto = document.getElementById('torneo-baloncesto').value || '[Torneo]';
                    const categoriaBaloncesto = document.getElementById('categoria-baloncesto').value || '[Categoría]';
                    const equipoLocalBaloncesto = document.getElementById('equipo-local-baloncesto').value || '[Local]';
                    const equipoVisitanteBaloncesto = document.getElementById('equipo-visitante-baloncesto').value || '[Visitante]';

                    // prefijar valores de cuartos del formulario si existen
                    const bq0 = document.getElementById('q1-local') ? document.getElementById('q1-local').value : '';
                    const bq1 = document.getElementById('q2-local') ? document.getElementById('q2-local').value : '';
                    const bq2 = document.getElementById('q3-local') ? document.getElementById('q3-local').value : '';
                    const bq3 = document.getElementById('q4-local') ? document.getElementById('q4-local').value : '';
                    const vq0 = document.getElementById('q1-visitante') ? document.getElementById('q1-visitante').value : '';
                    const vq1 = document.getElementById('q2-visitante') ? document.getElementById('q2-visitante').value : '';
                    const vq2 = document.getElementById('q3-visitante') ? document.getElementById('q3-visitante').value : '';
                    const vq3 = document.getElementById('q4-visitante') ? document.getElementById('q4-visitante').value : '';

                    // obtener playersLocal/playersVisit como ya hacía el código existente
                    const playersLocalBaloncesto = Array.from(document.querySelectorAll('#plantilla-local-baloncesto .competitor-row')).map(r => {
                        return {
                            name: r.querySelector('.competidor-input') ? r.querySelector('.competidor-input').value : '',
                            dorsal: r.querySelector('.dorsal-input') ? r.querySelector('.dorsal-input').value : ''
                        };
                    });
                    const playersVisitBaloncesto = Array.from(document.querySelectorAll('#plantilla-visitante-baloncesto .competitor-row')).map(r => {
                        return {
                            name: r.querySelector('.competidor-input') ? r.querySelector('.competidor-input').value : '',
                            dorsal: r.querySelector('.dorsal-input') ? r.querySelector('.dorsal-input').value : ''
                        };
                    });

                    // En la sección del preview donde se crean inputs .bb-q se prefijan sus value:
                    previewHTML = `
                        <div class="template-title">Formatos Oficiales para Competencias</div>
                        <div class="template-subtitle">${torneoBaloncesto}</div>
                        <div class="template-info">
                            <div class="info-item"><strong>CATEGORIA:</strong> ${categoriaBaloncesto}</div>
                        </div>

                        <div style="display:flex;justify-content:space-between;margin-bottom:1rem;">
                            <div><strong>Local:</strong> ${equipoLocalBaloncesto}</div>
                            <div><strong>Visitante:</strong> ${equipoVisitanteBaloncesto}</div>
                        </div>

                        <div style="text-align:center;margin-bottom:1rem;">
                            <h2>Resultado: <input type="number" id="bb-total-local" class="preview-total" readonly> - <input type="number" id="bb-total-visit" class="preview-total" readonly></h2>
                        </div>

                        <table class="template">
                            <thead>
                                <tr>
                                    <th>Equipo</th>
                                    <th>1°</th>
                                    <th>2°</th>
                                    <th>3°</th>
                                    <th>4°</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>${equipoLocalBaloncesto}</strong></td>
                                    <td><input type="number" class="bb-q" data-team="local" data-q="0" value="${bq0}"></td>
                                    <td><input type="number" class="bb-q" data-team="local" data-q="1" value="${bq1}"></td>
                                    <td><input type="number" class="bb-q" data-team="local" data-q="2" value="${bq2}"></td>
                                    <td><input type="number" class="bb-q" data-team="local" data-q="3" value="${bq3}"></td>
                                    <td><input readonly class="preview-total bb-total" data-team="local"></td>
                                </tr>
                                <tr>
                                    <td><strong>${equipoVisitanteBaloncesto}</strong></td>
                                    <td><input type="number" class="bb-q" data-team="visitante" data-q="0" value="${vq0}"></td>
                                    <td><input type="number" class="bb-q" data-team="visitante" data-q="1" value="${vq1}"></td>
                                    <td><input type="number" class="bb-q" data-team="visitante" data-q="2" value="${vq2}"></td>
                                    <td><input type="number" class="bb-q" data-team="visitante" data-q="3" value="${vq3}"></td>
                                    <td><input readonly class="preview-total bb-total" data-team="visitante"></td>
                                </tr>
                            </tbody>
                        </table>

                        <div style="margin-top:1rem;">
                            <h3>Plantillas</h3>
                            <table class="template">
                                <thead>
                                    <tr><th>N°</th><th>Local - Nombre</th><th>Dorsal</th><th>Visitante - Nombre</th><th>Dorsal</th></tr>
                                </thead>
                                <tbody>
                                    ${Array.from({length: 12}, (_, i) => `
                                        <tr>
                                            <td>${i+1}</td>
                                            <td><input class="preview-input"></td>
                                            <td><input class="preview-input" style="width:60px;"></td>
                                            <td><input class="preview-input"></td>
                                            <td><input class="preview-input" style="width:60px;"></td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `;
                    break;
            }
            
            document.getElementById('preview').innerHTML = previewHTML;
            attachPreviewListeners(); // asegurar listeners en inputs de preview
        }

        // Adjuntar listeners a inputs dentro de la preview para recalcular totales
        function attachPreviewListeners() {
            // Voleibol: sumar sets -> vp-total
            document.querySelectorAll('.vp-set').forEach(inp => {
                inp.addEventListener('input', () => {
                    ['local', 'visitante'].forEach(team => {
                        const sets = Array.from(document.querySelectorAll(`.vp-set[data-team="${team}"]`)).map(i => parseInt(i.value) || 0);
                        const totalEl = document.querySelector(`.vp-total[data-team="${team}"]`);
                        if (totalEl) totalEl.value = sets.reduce((a,b)=>a+b,0);
                    });
                });
            });

            // Baloncesto: sumar 4 cuartos -> bb-total and top summary
            document.querySelectorAll('.bb-q').forEach(inp => {
                inp.addEventListener('input', () => {
                    ['local','visitante'].forEach(team => {
                        const qEls = Array.from(document.querySelectorAll(`.bb-q[data-team="${team}"]`));
                        const total = qEls.reduce((acc, el) => acc + (parseInt(el.value)||0), 0);
                        const totalCell = document.querySelector(`.bb-total[data-team="${team}"]`);
                        if (totalCell) totalCell.value = total;
                    });
                    // actualizar resumen superior si existen
                    const left = document.querySelector('.bb-total[data-team="local"]');
                    const right = document.querySelector('.bb-total[data-team="visitante"]');
                    if (left && right) {
                        const topLeft = document.getElementById('bb-total-local');
                        const topRight = document.getElementById('bb-total-visit');
                        if (topLeft) topLeft.value = parseInt(left.value) || 0;
                        if (topRight) topRight.value = parseInt(right.value) || 0;
                    }
                });
            });

            // Inicializar cálculos (disparar evento input para precalcular valores vacíos)
            document.querySelectorAll('.vp-set, .bb-q').forEach(e => e.dispatchEvent(new Event('input')));
        }

        // Establecer fecha actual por defecto
        window.onload = function() {
            const today = new Date();
            const yyyy = today.getFullYear();
            let mm = today.getMonth() + 1;
            let dd = today.getDate();
            
            if (dd < 10) dd = '0' + dd;
            if (mm < 10) mm = '0' + mm;
            
            const formattedToday = `${yyyy}-${mm}-${dd}`;
            document.getElementById('fecha-salto').value = formattedToday;
            document.getElementById('fecha-carrera').value = formattedToday;
            document.getElementById('fecha-lanzamiento').value = formattedToday;
            document.getElementById('fecha-voleibol').value = formattedToday;
            document.getElementById('fecha-futbol').value = formattedToday;
            document.getElementById('fecha-baloncesto').value = formattedToday;
            
            // Adjuntar listeners específicos
            attachBaloncestoListeners();

            // Generar vista previa inicial
            generarPreview('salto');
        };
    </script>
</body>
</html>